1.
#!/bin/sh
echo '>>> Get old container id'
CID=$(docker ps | grep "soonenough/tryouts-distributed-web" | awk '{print $1}')
echo $CID
sudo /usr/bin/docker build -t soonenough/tryouts-distributed-web $JENKINS_HOME/workspace/build_wb_server_image/WbWebTest | tee $JENKINS_HOME/build_wb_server_imageDocker_build_result.log
echo '>>> Stopping old container'
if [ "$CID" != "" ];then
sudo  /usr/bin/docker stop $CID
fi
echo '>>> Restarting docker'
sudo service docker restart
sleep 5

echo '>>> Starting new container'
sudo /usr/bin/docker run -p 9092:8080 -d soonenough/tryouts-distributed-web

2.
#!/bin/sh
cd $JENKINS_HOME/workspace/build_wb_server_image/WbWebTest
docker build -t soonenough/tryouts-distributed-web:20180416 . | tee docker_build_result.log


cd $JENKINS_HOME/WbWebTest/

3.
docker run --name jenkins_local_server5 -d -p 9095:8080 -v /var/run/docker.sock:/var/run/docker.sock -u jenkins:0 soonenough/docker_in_jenkins
curl -O https://get.docker.com/builds/Linux/x86_64/docker-latest.tgz && tar zxvf docker-latest.tgz && cp docker/docker /usr/local/bin/ && rm -rf docker docker-latest.tgz

ARG DOCKER_GID=999 USER jenkins:${DOCKER_GID}

$docker build -t jenkins-docker --build-arg DOCKER_GID=20


docker cp /Users/huangwenbo/git/WbCodeBase/WbWebTest b132dade7b08:/var/jenkins_home
--user jenkins:1234

